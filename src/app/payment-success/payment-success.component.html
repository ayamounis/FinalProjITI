<div class="success-container">
  <div class="success-content">

    @if (isLoading) {
      <div class="loading-section">
        <div class="loading-animation">
          <div class="spinner"></div>
          <div class="loading-dots">
            <span></span>
            <span></span>
            <span></span>
          </div>
        </div>
        <h2>Processing your payment...</h2>
        <p>Please wait while we confirm your transaction.</p>
      </div>
    }

    @if (!isLoading && order) {
      <div class="success-section">
        <div class="success-animation">
          <div class="checkmark">
            <svg width="100" height="100" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3">
              <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path>
              <polyline points="22,4 12,14.01 9,11.01"></polyline>
            </svg>
          </div>
        </div>

        <div class="success-header">
          <h1>üéâ Payment Successful!</h1>
          <p class="success-message">Your order has been confirmed and payment processed successfully.</p>
          <div class="success-badge">
            <span>‚úì Confirmed</span>
          </div>
        </div>

        <div class="order-summary">
          <div class="summary-card">
            <h3>Order Summary</h3>
            <div class="summary-grid">
              <div class="summary-item">
                <span class="label">Order ID</span>
                <span class="value">#{{ order.orderId }}</span>
              </div>
              <div class="summary-item">
                <span class="label">Order Date</span>
                <span class="value">{{ formatDate(order.orderDate) }}</span>
              </div>
              <div class="summary-item">
                <span class="label">Total Amount</span>
                <span class="value amount">${{ formatPrice(order.totalAmount) }}</span>
              </div>
              <div class="summary-item">
                <span class="label">Status</span>
                <span class="value status-badge">{{ getOrderStatus(order.status) }}</span>
              </div>
            </div>
          </div>
        </div>

        @if (order.orderItems && order.orderItems.length > 0) {
          <div class="order-items">
            <h3>Your Products</h3>
            <div class="items-grid">
              @for (item of order.orderItems; track $index) {
                <div class="item-card">
                  <div class="item-image">
                    <img [src]="item.customProduct.customImageUrl"
                         [alt]="item.customProduct.customName"
                         onerror="this.src='assets/images/placeholder.jpg'">
                  </div>
                  <div class="item-details">
                    <h4>{{ item.customProduct.customName }}</h4>
                    <p class="item-quantity">Quantity: {{ item.quantity }}</p>
                    <p class="item-price">${{ formatPrice(item.totalPrice) }}</p>
                  </div>
                </div>
              }
            </div>
          </div>
        } @else {
          <div class="order-items">
            <h3>Payment Confirmed</h3>
            <div class="success-message-card">
              <div class="success-icon">‚úÖ</div>
              <p>Your payment has been processed successfully!</p>
              <p>You will receive an email confirmation shortly.</p>
            </div>
          </div>
        }

        <div class="next-steps">
          <h3>What's Next?</h3>
          <div class="steps-grid">
            <div class="step-item">
              <div class="step-icon">üìß</div>
              <div class="step-content">
                <h4>Order Confirmation</h4>
                <p>You'll receive an email confirmation shortly</p>
              </div>
            </div>
            <div class="step-item">
              <div class="step-icon">üöö</div>
              <div class="step-content">
                <h4>Order Processing</h4>
                <p>We'll start processing your order within 24 hours</p>
              </div>
            </div>
            <div class="step-item">
              <div class="step-icon">üì±</div>
              <div class="step-content">
                <h4>Track Your Order</h4>
                <p>You can track your order status in your account</p>
              </div>
            </div>
          </div>
        </div>

        <div class="actions">
          <button class="btn btn-primary" (click)="goToOrders()">
            <span>üìã</span>
            View My Orders
          </button>
          <button class="btn btn-secondary" (click)="printReceipt()">
            <span>üñ®Ô∏è</span>
            Print Receipt
          </button>
          <button class="btn btn-secondary" (click)="continueShopping()">
            <span>üõçÔ∏è</span>
            Continue Shopping
          </button>
        </div>
      </div>
    }

    @if (!isLoading && !order && hasError) {
      <div class="error-section">
        <div class="error-animation">
          <div class="error-icon">
            <svg width="100" height="100" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3">
              <circle cx="12" cy="12" r="10"></circle>
              <line x1="15" y1="9" x2="9" y2="15"></line>
              <line x1="9" y1="9" x2="15" y2="15"></line>
            </svg>
          </div>
        </div>

        <div class="error-header">
          <h1>‚ùå Payment Failed</h1>
          <p class="error-message">{{ errorMessage }}</p>
        </div>

        <div class="actions">
          <button class="btn btn-primary" (click)="goToCart()">
            <span>üõí</span>
            Back to Cart
          </button>
          <button class="btn btn-secondary" (click)="continueShopping()">
            <span>üõçÔ∏è</span>
            Continue Shopping
          </button>
        </div>
      </div>
    }

  </div>
</div>
